@echo off

secedit /export /cfg LocalSecurityPolicy.txt > NUL

:: W-01 administrator name is exist
net user | findstr /i administrator > NUL

if ERRORLEVEL == 1 (
    echo W-01 safe
) else (
    echo W-01 vulnerability
)

:: W-02 Guset is exist
net user | findstr /i guest > NUL
if ERRORLEVEL == 1 (
    echo W-02 safe
) else (
    echo W-02 vulnerability
)

:: W-04 
:: hangul is not wroking
:: failed code
:: for /f "tokens=*" %%i in ('net accounts') do (
::    echo %%i | findstr "임계값"   
:: )

for /f "tokens=3 delims= " %%i in ('type LocalSecurityPolicy.txt ^| find /i "LockoutBadCount"') do set _result=%%i
echo %_result% | findstr /i "0 1 2 3 4 5" > NUL
if ERRORLEVEL == 1 (
    echo W-04 safe
) else (
    echo W-04 vulnerability
)

:: another method is secedit /export /cfg c:\test.inf
:: but, you require a administrator privileges

:: W-05
secedit /export /cfg LocalSecurityPolicy.txt > NUL
type LocalSecurityPolicy.txt | find /i "ClearTextPassword" | find "0" > NUL
if ERRORLEVEL == 1 (
    echo W-05 vulnerability
) else (
    echo W-05 safe
)


:: done
:: del LocalSecurityPolicy.txt