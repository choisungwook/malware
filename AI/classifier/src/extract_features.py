#-*- coding: utf-8 -*-
import raw_features
import pefile
import sys
import logging

mylogger = logging.getLogger('extract_features')
mylogger.setLevel(logging.INFO)

# 타겟
target = 'C:\\Windows\\notepad.exe'

try:
    pe = pefile.PE(target)

    '''
        PE포맷의 DOS헤더 추출
        실패시 프로그램 종료
    '''
    dos_header = raw_features.extract_dos_header(pe)
    if dos_header is None:
        mylogger.info('Extracting dos_header is failed')
        sys.exit(-1)

    '''
        PE포맷의 OPTIONAL헤더 추출
        실패시 프로그램 종료
    '''
    optional_header = raw_features.extract_optional_header(pe)
    if optional_header is None:
        mylogger.info('Extracting optional_header is failed')
        sys.exit(-1)

except Exception as e:
    mylogger.info('Load PE is failed')

print('Done')