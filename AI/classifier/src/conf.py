#-*- coding: utf-8 -*-
import collections

testtarget = '/home/choi/Desktop/TrainSet/0987c3ac15d7c38370c0eb6deb2cb2a2.vir'

# DOS 헤더
# 자료형 -> python pefile: https://github.com/erocarrera/pefile/blob/master/pefile.py
__IMAGE_DOS_HEADER_format__ = ('IMAGE_DOS_HEADER',
                               ('H,e_magic', 'H,e_cblp', 'H,e_cp',
                                'H,e_crlc', 'H,e_cparhdr', 'H,e_minalloc',
                                'H,e_maxalloc', 'H,e_ss', 'H,e_sp', 'H,e_csum',
                                'H,e_ip', 'H,e_cs', 'H,e_lfarlc', 'H,e_ovno', '8s,e_res',
                                'H,e_oemid', 'H,e_oeminfo', '20s,e_res2',
                                'I,e_lfanew'))

# FILE 헤더
# 자료형 -> python pefile: https://github.com/erocarrera/pefile/blob/master/pefile.py
__IMAGE_FILE_HEADER_format__ = ('IMAGE_FILE_HEADER',
                                ('H,Machine', 'H,NumberOfSections',
                                 'I,TimeDateStamp', 'I,PointerToSymbolTable',
                                 'I,NumberOfSymbols', 'H,SizeOfOptionalHeader',
                                 'H,Characteristics'))

# OPTIONAL 헤더
# 자료형 -> python pefile: https://github.com/erocarrera/pefile/blob/master/pefile.py
__IMAGE_OPTIONAL_HEADER_format__ = ('IMAGE_OPTIONAL_HEADER',
        ('H,Magic', 'B,MajorLinkerVersion',
        'B,MinorLinkerVersion', 'I,SizeOfCode',
        'I,SizeOfInitializedData', 'I,SizeOfUninitializedData',
        'I,AddressOfEntryPoint', 'I,BaseOfCode', 'I,BaseOfData',
        'I,ImageBase', 'I,SectionAlignment', 'I,FileAlignment',
        'H,MajorOperatingSystemVersion', 'H,MinorOperatingSystemVersion',
        'H,MajorImageVersion', 'H,MinorImageVersion',
        'H,MajorSubsystemVersion', 'H,MinorSubsystemVersion',
        'I,Reserved1', 'I,SizeOfImage', 'I,SizeOfHeaders',
        'I,CheckSum', 'H,Subsystem', 'H,DllCharacteristics',
        'I,SizeOfStackReserve', 'I,SizeOfStackCommit',
        'I,SizeOfHeapReserve', 'I,SizeOfHeapCommit',
        'I,LoaderFlags', 'I,NumberOfRvaAndSizes' ))

# Section 헤더
# 자료형 -> python pefile: https://github.com/erocarrera/pefile/blob/master/pefile.py
__IMAGE_SECTION_HEADER_format__ = ('IMAGE_SECTION_HEADER',
                                   ('8s,Name', 'I,Misc,Misc_PhysicalAddress,Misc_VirtualSize',
                                    'I,VirtualAddress', 'I,SizeOfRawData', 'I,PointerToRawData',
                                    'I,PointerToRelocations', 'I,PointerToLinenumbers',
                                    'H,NumberOfRelocations', 'H,NumberOfLinenumbers',
                                    'I,Characteristics'))